[2024-07-02 15:49:21,131][train.py][line:67][INFO] ---------------args---------------
Namespace(data_path='../MOF/data/Pymatgen_Wrapped/1/', train_name='ResTcn_8500', model_path=None, learning_rate=0.0001, min_learning_rate=1e-05, start_scheduler_step=50, weight_decay=1e-05, momentum=0.99, batch_size=256, class_num=230, epoch_num=200, model_save_path='./checkpoints/ResTcn_8500_1', device='0', scheduler_T=None, num_workers=20, log_name='log/train//train_ResTcn_8500_2024_07_02_15:49:17.log')
[2024-07-02 15:49:21,145][train.py][line:68][INFO] ---------------model---------------
ResTcn(
  (conv): ModuleList(
    (0): Sequential(
      (0): ResBlock1D(
        (pre): Conv1d(2, 32, kernel_size=(1,), stride=(1,), bias=False)
        (conv): Sequential(
          (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (1): Sequential(
      (0): ResBlock1D(
        (pre): Identity()
        (conv): Sequential(
          (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (2): Sequential(
      (0): ResBlock1D(
        (pre): Conv1d(32, 64, kernel_size=(1,), stride=(1,), bias=False)
        (conv): Sequential(
          (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (3): Sequential(
      (0): ResBlock1D(
        (pre): Identity()
        (conv): Sequential(
          (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (4): Sequential(
      (0): ResBlock1D(
        (pre): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
        (conv): Sequential(
          (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (5): Sequential(
      (0): ResBlock1D(
        (pre): Identity()
        (conv): Sequential(
          (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (6): Sequential(
      (0): ResBlock1D(
        (pre): Conv1d(128, 256, kernel_size=(1,), stride=(1,), bias=False)
        (conv): Sequential(
          (0): Conv1d(256, 256, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(256, 256, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (7): Sequential(
      (0): ResBlock1D(
        (pre): Identity()
        (conv): Sequential(
          (0): Conv1d(256, 256, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(256, 256, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (8): Sequential(
      (0): ResBlock1D(
        (pre): Conv1d(256, 512, kernel_size=(1,), stride=(1,), bias=False)
        (conv): Sequential(
          (0): Conv1d(512, 512, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(512, 512, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (9): Sequential(
      (0): ResBlock1D(
        (pre): Identity()
        (conv): Sequential(
          (0): Conv1d(512, 512, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(512, 512, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (10): Sequential(
      (0): ResBlock1D(
        (pre): Conv1d(512, 1024, kernel_size=(1,), stride=(1,), bias=False)
        (conv): Sequential(
          (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
    (11-12): 2 x Sequential(
      (0): ResBlock1D(
        (pre): Identity()
        (conv): Sequential(
          (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,), bias=False)
          (4): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (relu): LeakyReLU(negative_slope=0.01)
      )
      (1): AvgPool1d(kernel_size=(2,), stride=(2,), padding=(0,))
    )
  )
  (mlp): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): Linear(in_features=512, out_features=230, bias=True)
  )
)
[2024-07-02 15:49:21,147][train.py][line:69][INFO] ---------------device---------------
cuda:0
[2024-07-02 15:49:21,147][train.py][line:70][INFO] ---------------optimizer---------------
AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 1e-05
)
[2024-07-02 15:49:21,148][train.py][line:71][INFO] ---------------lossfn---------------
CrossEntropyLoss()
[2024-07-02 15:49:21,173][train.py][line:83][INFO] ---------------epoch 1---------------
lr: [0.0001]
[2024-07-02 15:55:20,704][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.095336333674015
[2024-07-02 15:58:23,542][train.py][line:138][INFO] [testing]total_number: 142617,error: 21.98858805253919,total_acc: 0.0035549758467823267
[2024-07-02 15:58:24,094][train.py][line:83][INFO] ---------------epoch 2---------------
lr: [0.0001]
[2024-07-02 16:01:23,910][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.9689938262131084
[2024-07-02 16:03:22,378][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.759898178631704,total_acc: 0.07166045904159546
[2024-07-02 16:03:22,884][train.py][line:83][INFO] ---------------epoch 3---------------
lr: [0.0001]
[2024-07-02 16:06:17,102][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.6182527738360726
[2024-07-02 16:08:20,854][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.5701423994087715,total_acc: 0.10925766080617905
[2024-07-02 16:08:21,394][train.py][line:83][INFO] ---------------epoch 4---------------
lr: [0.0001]
[2024-07-02 16:11:14,764][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.5422245057368236
[2024-07-02 16:13:14,305][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.520195279981543,total_acc: 0.11752455681562424
[2024-07-02 16:13:15,002][train.py][line:83][INFO] ---------------epoch 5---------------
lr: [0.0001]
[2024-07-02 16:16:07,878][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.467624435491612
[2024-07-02 16:18:04,323][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.4286921972151188,total_acc: 0.13369373977184296
[2024-07-02 16:18:05,027][train.py][line:83][INFO] ---------------epoch 6---------------
lr: [0.0001]
[2024-07-02 16:20:56,866][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.3941276850090762
[2024-07-02 16:22:55,995][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.535099368588102,total_acc: 0.11641670018434525
[2024-07-02 16:22:56,150][train.py][line:83][INFO] ---------------epoch 7---------------
lr: [0.0001]
[2024-07-02 16:25:51,742][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.6393667983507734
[2024-07-02 16:27:56,330][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.616381907838865,total_acc: 0.0982421487569809
[2024-07-02 16:27:56,444][train.py][line:83][INFO] ---------------epoch 8---------------
lr: [0.0001]
[2024-07-02 16:30:48,558][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.58301041005163
[2024-07-02 16:32:49,810][train.py][line:138][INFO] [testing]total_number: 142617,error: 3.6073267163411957,total_acc: 0.11310011893510818
[2024-07-02 16:32:49,890][train.py][line:83][INFO] ---------------epoch 9---------------
lr: [0.0001]
[2024-07-02 16:35:46,556][train.py][line:100][INFO] [training]total_num: 142617.0,error: 3.522658918450885
