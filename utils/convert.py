


def per_class_acc2sum_acc(class_cnt,class_acc,class_idx):
    acc_n,n = 0.0,0.0
    for i in class_idx:
        acc_n += class_cnt[i]*class_acc[i]  
        n+= class_cnt[i]
    return  acc_n/n

def per_class_acc2hmt_acc(class_acc,balanced=False):    
    # 按照30% 30% 40% 划档
    test_dis = [5013, 9433, 75, 9261, 4497, 18, 2432, 175, 5626, 61, 2345, 903, 3526, 9425, 9425, 22, 38, 2148, 9325, 913, 31, 18, 126, 33, 2, 75, 17, 8, 4112, 70, 275, 89, 7400, 155, 5, 694, 58, 21, 0, 98, 0, 38, 1812, 36, 313, 72, 15, 37, 10, 54, 26, 590, 70, 256, 151, 1888, 496, 353, 133, 4498, 9396, 5199, 481, 0, 102, 66, 0, 0, 62, 588, 72, 214, 157, 143, 28, 472, 61, 421, 133, 126, 116, 705, 16, 47, 449, 666, 360, 1914, 3, 51, 45, 978, 4, 105, 46, 927, 47, 101, 1, 3, 3, 13, 17, 60, 1, 53, 11, 18, 23, 213, 2, 17, 138, 624, 3, 20, 32, 94, 16, 55, 87, 344, 78, 47, 30, 112, 20, 91, 88, 246, 70, 10, 25, 28, 49, 92, 56, 73, 115, 72, 126, 273, 113, 388, 385, 715, 617, 4443, 6, 54, 13, 483, 11, 381, 249, 2, 9, 51, 185, 128, 516, 29, 242, 48, 384, 312, 912, 12, 355, 346, 40, 30, 365, 16, 23, 397, 15, 146, 125, 40, 24, 96, 1, 7, 18, 47, 21, 7, 22, 88, 65, 59, 38, 181, 10, 57, 83, 292, 67, 12, 25, 23, 54, 64, 428, 70, 13, 2, 35, 30, 29, 24, 33, 14, 21, 21, 163, 70, 48, 146, 127, 77, 38, 16, 340, 41, 88, 71, 22, 58]
    if balanced:
        test_dis = [10 if test_dis[i] >= 10 else 0 for i in range(230)]
    head_idx = [1, 14, 13, 60, 18, 3, 32, 8, 61, 0, 59, 4, 147, 28, 12, 6, 10, 17, 87, 55, 42, 91, 95, 19, 166, 11, 145, 81, 35, 85, 113, 146, 51, 69, 160, 56, 151, 62, 75, 84, 204, 77, 175, 143, 144, 164, 153, 172, 86, 168, 57, 169, 121, 224, 44, 165, 197, 30, 141, 53, 154, 129, 162, 71, 109, 158, 193, 7, 216]
    medium_idx = [72, 33, 54, 219, 177, 73, 112, 78, 58, 159, 220, 140, 79, 22, 178, 80, 138, 142, 125, 93, 64, 97, 39, 181, 117, 135, 127, 31, 226, 189, 128, 120, 196, 122, 221, 25, 2, 137, 139, 70, 45, 227, 217, 205, 130, 52, 29, 198, 65, 190, 203, 68, 76, 9, 103, 191, 229, 36, 195, 136, 119, 202, 149, 49, 105, 157, 89, 134, 218]
    tail_idx = [163, 185, 123, 96, 83, 94, 90, 225, 179, 170, 222, 192, 41, 16, 47, 43, 208, 212, 23, 116, 20, 209, 171, 124, 210, 161, 133, 74, 50, 200, 132, 211, 180, 201, 174, 108, 228, 188, 15, 215, 214, 186, 37, 126, 115, 184, 107, 21, 5, 111, 102, 26, 223, 173, 118, 82, 176, 46, 213, 206, 150, 101, 199, 167, 152, 106, 194, 131, 48, 156, 27, 187, 183, 148, 34, 92, 114, 100, 99, 88, 207, 155, 110, 24, 182, 104, 98, 67, 66, 63, 40, 38]

    return per_class_acc2sum_acc(test_dis,class_acc,head_idx),per_class_acc2sum_acc(test_dis,class_acc,medium_idx),per_class_acc2sum_acc(test_dis,class_acc,tail_idx)

# def space_group2lattice_type(space_group:int):

